"use strict";(self.webpackChunkbjj_app=self.webpackChunkbjj_app||[]).push([[19],{4019:(B,u,a)=>{a.r(u),a.d(u,{ScheduleModule:()=>Q});var d=a(6814),l=a(6223),p=a(4581),f=a(8525),x=a(2032),C=a(5986),_=a(9157),v=a(324),e=a(5879),y=a(9862);let h=(()=>{class n{constructor(t){this.http=t,this.apiUrl="https://bjj-app.onrender.com/api/schedule"}getWeekSchedule(){return this.http.get(`${this.apiUrl}/week`)}addClassToSchedule(t,s){return this.http.post(`${this.apiUrl}/add-class`,{classId:t,date:s})}createScheduleForWeek(t){return this.http.post(`${this.apiUrl}/create-week`,{weekStarting:t})}createDayInSchedule(t){return this.http.post(`${this.apiUrl}/create-day`,t)}updateDayInSchedule(t){return this.http.put(`${this.apiUrl}/update-day`,t)}deleteDayInSchedule(t){return this.http.delete(`${this.apiUrl}/delete-day`,{body:t})}static#e=this.\u0275fac=function(s){return new(s||n)(e.LFG(y.eN))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var M=a(3076);const O=function(n,i){return{matA:n,matB:i}};function S(n,i){if(1&n&&(e.TgZ(0,"li",16)(1,"h3"),e._uU(2),e.qZA(),e.TgZ(3,"div",17),e._UZ(4,"i",18),e.TgZ(5,"div")(6,"h2"),e._uU(7),e.qZA()()(),e.TgZ(8,"div",19)(9,"p"),e._uU(10),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.qZA()()()),2&n){const t=i.$implicit;e.Q6J("ngClass",e.WLB(6,O,"A"===t.class.mat,"B"===t.class.mat)),e.xp6(2),e.Oqu(t.class.name),e.xp6(5),e.AsE("",t.class.start," - ",t.class.end,""),e.xp6(3),e.hij("Mat: ",t.class.mat,""),e.xp6(2),e.hij("Prof: ",t.class.professor,"")}}function b(n,i){if(1&n&&(e.TgZ(0,"ul",14),e.YNc(1,S,13,9,"li",15),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.classes)}}const Z=function(n){return[n]};function T(n,i){if(1&n&&(e.TgZ(0,"li",9)(1,"h2",10),e._uU(2),e.qZA(),e.YNc(3,b,2,1,"ul",11),e.TgZ(4,"button",12),e._UZ(5,"i",13),e.qZA()()),2&n){const t=i.$implicit,s=e.oxw(2);e.xp6(2),e.Oqu(t.dayName),e.xp6(1),e.Q6J("ngIf",t.classes),e.xp6(1),e.Q6J("routerLink",e.VKq(3,Z,"/admin/dashboard/main-schedule/up-schedule/"+s.formatDayForUrl(t.day)))}}function w(n,i){if(1&n&&(e.TgZ(0,"option",20),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function A(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"ul",2),e.YNc(2,T,6,5,"li",3),e.qZA(),e.TgZ(3,"div",4)(4,"select",5),e.NdJ("ngModelChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.selectedCoachName=o)}),e.TgZ(5,"option",6),e._uU(6,"All coache's classes"),e.qZA(),e.YNc(7,w,2,2,"option",7),e.qZA(),e.TgZ(8,"button",8),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onFilterByCoach())}),e._uU(9,"Filter"),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.weekSchedule.days),e.xp6(2),e.Q6J("ngModel",t.selectedCoachName),e.xp6(3),e.Q6J("ngForOf",t.coaches)}}let P=(()=>{class n{constructor(t,s){this.scheduleService=t,this.userService=s,this.selectedCoachName=""}ngOnInit(){this.loadWeekSchedule(),this.loadCoaches()}loadWeekSchedule(){this.scheduleService.getWeekSchedule().subscribe(t=>{this.weekSchedule=this.sortClasses(t),console.log(this.weekSchedule)},t=>{console.error("Error loading week schedule",t)})}formatDayForUrl(t){return new Date(t).toISOString().split("T")[0]}loadCoaches(){this.userService.getusers().subscribe(t=>{this.coaches=t.filter(s=>"COACH"===s.type||"HEAD-PROFESSOR"===s.type||"PROFESSOR"===s.type).map(s=>s.name)})}onFilterByCoach(){this.selectedCoachName?this.scheduleService.getWeekSchedule().subscribe(t=>{this.weekSchedule=this.sortClasses(t,this.selectedCoachName)},t=>{console.error("Error loading week schedule",t)}):this.loadWeekSchedule()}sortClasses(t,s=""){return{...t,days:t.days.map(o=>({...o,classes:o.classes.filter(c=>!s||c.class.professor===s).sort((c,r)=>{const g=new Date("1970-01-01T"+c.class.start),m=new Date("1970-01-01T"+r.class.start);return g<m?-1:g>m?1:c.class.mat.localeCompare(r.class.mat)})}))}}static#e=this.\u0275fac=function(s){return new(s||n)(e.Y36(h),e.Y36(M.K))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-main-schedule"]],decls:1,vars:1,consts:[["class","schedule-container",4,"ngIf"],[1,"schedule-container"],[1,"schedule-list"],["class","day-container",4,"ngFor","ngForOf"],[1,"filter-section"],[3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"click"],[1,"day-container"],[1,"day-name"],["class","classes-list",4,"ngIf"],[1,"update-icon",3,"routerLink"],[1,"fa-solid","fa-pen-to-square"],[1,"classes-list"],["class","class-container",3,"ngClass",4,"ngFor","ngForOf"],[1,"class-container",3,"ngClass"],[1,"class-time"],[1,"fa-regular","fa-clock"],[1,"class-data"],[3,"value"]],template:function(s,o){1&s&&e.YNc(0,A,10,3,"div",0),2&s&&e.Q6J("ngIf",o.weekSchedule)},dependencies:[d.mk,d.sg,d.O5,p.rH,l.YN,l.Kr,l.EJ,l.JJ,l.On],styles:[".schedule-container[_ngcontent-%COMP%]{width:100%;min-height:100vh;background-color:#fff;color:#000;overflow:hidden;display:flex;flex-direction:column;align-items:center;box-sizing:border-box;padding:0 40px 40px;list-style:none}.schedule-list[_ngcontent-%COMP%]{min-width:1300px;display:flex;justify-content:center;flex-wrap:wrap;margin:40px 0 0;overflow:hidden;padding:0}li[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;position:relative}.day-container[_ngcontent-%COMP%]{background-color:#f5f5f5;margin:5px;width:13%;padding-bottom:50px}.day-name[_ngcontent-%COMP%]{background-color:#000;color:#fff;width:100%;height:50px;margin:0;padding:0;line-height:50px;text-align:center;font-weight:500;text-transform:uppercase;font-size:16px}.classes-list[_ngcontent-%COMP%]{padding:10px 5px;box-sizing:border-box;overflow:hidden;margin:0;display:flex;flex-direction:column;align-items:center}.class-container[_ngcontent-%COMP%]{border-radius:.5rem;margin-bottom:10px;width:100%;overflow:hidden;cursor:pointer;transition:all 1s ease}.class-container[_ngcontent-%COMP%]:hover{background-color:#424242}.class-container[_ngcontent-%COMP%]:hover   h3[_ngcontent-%COMP%]{background-color:#111;color:#fff}.class-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:12px;letter-spacing:1px;margin:10px;background-color:#ff4992;color:#fff;font-weight:600;text-transform:uppercase;padding:5px 10px;box-sizing:border-box;transition:all 1s ease;border-radius:.5rem;text-align:center}.class-time[_ngcontent-%COMP%]{width:99%;margin:10px 5px;display:flex;align-items:center;box-sizing:border-box;padding:6px 10px 5px}.class-time[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:30px}.class-time[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-left:20px}.class-time[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:12px;margin:2px 0 0;padding:0;border-radius:.5rem}.class-data[_ngcontent-%COMP%]{box-sizing:border-box;padding:10px;margin:0 10px 10px;background-color:#202020}.class-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 5px;padding:0;font-size:12px;font-weight:600}.matA[_ngcontent-%COMP%]{background-color:#000;color:#fff}.matB[_ngcontent-%COMP%]{background-color:#47444d;color:#fff}.matB[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:12px;letter-spacing:1px;margin:10px;background-color:#49ffea;color:#000;font-weight:600;text-transform:uppercase;padding:5px 10px;box-sizing:border-box;transition:all 1s ease;border-radius:.5rem;text-align:center}.filter-section[_ngcontent-%COMP%]{min-width:1200px;display:flex;flex-direction:column;align-items:center;background-color:#999;margin-top:20px;padding:30px}.filter-section[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:90%;height:40px;padding-left:30px}.filter-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:20px}"]})}return n})(),U=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-new-schedule"]],decls:2,vars:0,template:function(s,o){1&s&&(e.TgZ(0,"p"),e._uU(1,"new-schedule works!"),e.qZA())}})}return n})(),k=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-user-schedule"]],decls:2,vars:0,template:function(s,o){1&s&&(e.TgZ(0,"p"),e._uU(1,"user-schedule works!"),e.qZA())}})}return n})();var F=a(8398),D=a(684);function J(n,i){if(1&n&&(e.TgZ(0,"div",6)(1,"h2"),e._uU(2),e.qZA(),e.TgZ(3,"p"),e._uU(4),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.dayData.dayName),e.xp6(2),e.Oqu(t.rightDay)}}function N(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"li",17)(1,"div",18)(2,"div",19),e._uU(3),e.qZA(),e.TgZ(4,"div",20),e._uU(5),e.qZA(),e.TgZ(6,"div",20),e._uU(7),e.ALo(8,"truncateWords"),e.qZA(),e.TgZ(9,"div",21),e._uU(10),e.qZA(),e.TgZ(11,"div",21),e._uU(12),e.qZA(),e.TgZ(13,"div",21),e._uU(14),e.qZA(),e.TgZ(15,"div",21)(16,"button",22),e.NdJ("click",function(){const c=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.removeClassFromClassDay(c.class._id))}),e._UZ(17,"i",23),e.qZA()()()()}if(2&n){const t=i.$implicit,s=i.index,o=e.oxw(2);e.xp6(3),e.Oqu(15*(o.page-1)+s+1),e.xp6(2),e.Oqu(t.class.name),e.xp6(2),e.hij("Level: ",e.lcZ(8,7,t.class.program[0].programName),""),e.xp6(3),e.hij("Mat: ",t.class.mat,""),e.xp6(2),e.hij("C: ",t.class.professor,""),e.xp6(2),e.AsE("",t.class.start," - ",t.class.end,"")}}function q(n,i){if(1&n&&(e.TgZ(0,"option",24),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.Q6J("value",t._id),e.xp6(1),e.HOy("",t.name," | Prof: ",t.professor," | Time: ",t.start," - ",t.end," ")}}function I(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",7)(1,"ul",8)(2,"li",9)(3,"ul",10),e._UZ(4,"br"),e.YNc(5,N,18,9,"li",11),e.qZA()()(),e.TgZ(6,"div",12)(7,"select",13),e.NdJ("ngModelChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.selectedClassId=o)}),e.TgZ(8,"option",14),e._uU(9,"--Select Class"),e.qZA(),e.YNc(10,q,2,5,"option",15),e.qZA(),e.TgZ(11,"button",16),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.addClassToDay())}),e._uU(12,"Add Class"),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.classes),e.xp6(2),e.Q6J("ngModel",t.selectedClassId),e.xp6(3),e.Q6J("ngForOf",t.dbClasses)}}const z=[{path:"",component:P},{path:"new-schedule",component:U},{path:"user-schedule/:id",component:k},{path:"up-schedule/:day",component:(()=>{class n{constructor(t,s,o){this.route=t,this.scheduleService=s,this.classService=o,this.classes=[],this.dbClasses=[],this.selectedClassId="",this.total=0,this.page=1}ngOnInit(){const t=this.route.snapshot.paramMap.get("day");this.rightDay=t,t&&(this.getWeekSchedule(t),this.getAllClasses())}getWeekSchedule(t){this.scheduleService.getWeekSchedule().subscribe(s=>{this.weekSchedule=s,this.dayData=s.days.find(o=>o.day.split("T")[0]===t),this.classes=this.dayData?this.sortClasses(this.dayData.classes):[],console.log("Datos del d\xeda:",this.dayData)},s=>console.error("Error al obtener los datos de la semana",s))}getAllClasses(){this.classService.getAllClasses().subscribe(t=>{this.dbClasses=t,console.log("Clases disponibles:",t)},t=>console.error("Error al obtener las clases",t))}addClassToDay(){const t=this.route.snapshot.paramMap.get("day");t&&this.selectedClassId&&(console.log("Fecha enviada:",t),this.scheduleService.addClassToSchedule(this.selectedClassId,t).subscribe(()=>{console.log("Clase agregada"),this.getWeekSchedule(t),this.getAllClasses()},s=>console.error("Error al agregar la clase al horario",s)))}sortClasses(t){return t.sort((s,o)=>{const c=new Date("1970-01-01T"+s.class.start),r=new Date("1970-01-01T"+o.class.start);return c<r?-1:c>r?1:s.class.mat.localeCompare(o.class.mat)})}removeClassFromClassDay(t){if(!confirm("Are you sure you want to remove this class?"))return;const s=this.dayData.classes.filter(c=>c.class._id!==t),o={weekStarting:this.weekSchedule.weekStarting,dayDate:this.dayData.day.split("T")[0],classes:s};this.scheduleService.updateDayInSchedule(o).subscribe(()=>{console.log("Class removed successfully"),this.getWeekSchedule(this.rightDay)},c=>{console.error("Error removing class from day",c)})}static#e=this.\u0275fac=function(s){return new(s||n)(e.Y36(p.gz),e.Y36(h),e.Y36(F.j))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-update-schedule"]],decls:7,vars:2,consts:[[1,"admin-container"],[1,"admin-top-menu"],["class","admin-top-menu-logo",4,"ngIf"],[1,"admin-top-menu-buttons"],["routerLink","/admin/dashboard/main-schedule",1,"button"],["class","schedule-container",4,"ngIf"],[1,"admin-top-menu-logo"],[1,"schedule-container"],[1,"schedule-list"],[1,"day-container"],[1,"table-list"],["class","class-container",4,"ngFor","ngForOf"],[1,"class-selector"],[3,"ngModel","ngModelChange"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],[3,"click"],[1,"class-container"],[1,"item-box"],[1,"item-index-number","item-xsmall"],[1,"items","item-medium"],[1,"items","item-small"],["type","button",1,"button-remove",3,"click"],[1,"fa-solid","fa-xmark"],[3,"value"]],template:function(s,o){1&s&&(e.TgZ(0,"section",0)(1,"section",1),e.YNc(2,J,5,2,"div",2),e.TgZ(3,"div",3)(4,"button",4),e._uU(5,"back"),e.qZA()()(),e.YNc(6,I,13,3,"div",5),e.qZA()),2&s&&(e.xp6(2),e.Q6J("ngIf",o.dayData),e.xp6(4),e.Q6J("ngIf",o.dayData))},dependencies:[d.sg,d.O5,p.rH,l.YN,l.Kr,l.EJ,l.JJ,l.On,D.d],styles:[".admin-top-menu-logo[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.admin-top-menu-logo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .admin-top-menu-logo[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0!important;padding:0!important}ul[_ngcontent-%COMP%], li[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none!important}.class-selector[_ngcontent-%COMP%]{background-color:#999;margin-top:20px;padding:30px}.class-selector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:90%;height:40px;padding-left:30px}.class-selector[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:20px}.button-remove[_ngcontent-%COMP%]{position:relative!important;width:28px!important;height:28px;background-color:#ee0c3d!important}"]})}return n})()}];let Y=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[p.Bz.forChild(z),p.Bz]})}return n})();var j=a(6472),E=a(682);let Q=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[d.ez,Y,p.Bz,l.UX,l.u5,j.JX,x.c,_.lN,f.LD,C.p9,v.Fk,E.G]})}return n})()}}]);